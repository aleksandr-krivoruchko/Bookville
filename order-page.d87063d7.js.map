{"mappings":"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","sources":["src/js/order.js","src/templates/order-item.hbs"],"sourcesContent":["import { refs } from './common-ref';\nimport orderItemTpl from '../templates/order-item.hbs';\n\nconst STORAGE_KEY = 'order-form';\n\nrender();\nsetBooksCountInOrder();\n\nrefs.orderForm.addEventListener('submit', onFormSubmit);\nrefs.orderForm.addEventListener('change', setInputToStorage);\n\ninitForm();\n\nfunction setInputToStorage(e) {\n  let persistedValues = localStorage.getItem(STORAGE_KEY);\n  persistedValues = persistedValues ? JSON.parse(persistedValues) : {};\n  persistedValues[e.target.name] = e.target.value;\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(persistedValues));\n}\n\nfunction onFormSubmit(e) {\n  e.preventDefault();\n  const obj = {};\n\n  let savedBooks = localStorage.getItem('booksInCart');\n  if (savedBooks) {\n    savedBooks = JSON.parse(savedBooks);\n  }\n  obj.order = savedBooks;\n\n  const formData = new FormData(refs.orderForm);\n\n  formData.forEach((value, name) => {\n    obj[name] = value;\n  });\n\n  console.log(obj);\n\n  localStorage.removeItem(STORAGE_KEY);\n  localStorage.removeItem('booksInCart');\n\n  e.currentTarget.reset();\n}\n\nfunction initForm() {\n  let dataStorage = localStorage.getItem(STORAGE_KEY);\n\n  if (dataStorage) {\n    dataStorage = JSON.parse(dataStorage);\n  }\n\n  Object.entries(dataStorage).forEach(([name, value]) => {\n    refs.orderForm.elements[name].value = value;\n  });\n}\n\nfunction render() {\n  const savedBooks = localStorage.getItem('booksInCart');\n  const booksInCart = JSON.parse(savedBooks);\n\n  console.log(booksInCart);\n\n  const markup = booksInCart.map(orderItemTpl);\n\n  refs.booksInOrder.insertAdjacentHTML('beforeend', markup.join(''));\n}\n\nfunction setBooksCountInOrder() {\n  let savedBooks = localStorage.getItem('booksInCart');\n\n  if (savedBooks) {\n    savedBooks = JSON.parse(savedBooks);\n  }\n  refs.totalPriceInOrder.textContent = savedBooks.length;\n}\n","<li class=\"order-card__item\">\n\t<div>\n\t\t<p class=\"card__author\">{{author}}</p>\n\t\t<p class=\"card__book\">{{name}}</p>\n\t</div>\n<div>\n\t\t<span class=\"card__amount\">1</span>\n\t\t<span>x</span>\n\t\t<span class=\"card__price\">{{price}}$</span>\n</div>\n</li>"],"names":["$8X9V8","parcelRequire","$3b5067c09d718231$export$2e2bcd8739ae039","$parcel$interopDefault","template","compiler","main","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","useData","savedBooks","localStorage","getItem","booksInCart","JSON","parse","console","log","markup","map","refs","booksInOrder","insertAdjacentHTML","join","$e367003b4ef79d54$var$render","totalPriceInOrder","textContent","length","$e367003b4ef79d54$var$setBooksCountInOrder","orderForm","addEventListener","e","preventDefault","obj","order","FormData","forEach","value","removeItem","currentTarget","reset","persistedValues","target","setItem","stringify","dataStorage","entries","elements","$e367003b4ef79d54$var$initForm"],"version":3,"file":"order-page.d87063d7.js.map"}